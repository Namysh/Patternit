var re=Object.defineProperty;var K=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var G=(e,t,s)=>t in e?re(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,M=(e,t)=>{for(var s in t||(t={}))le.call(t,s)&&G(e,s,t[s]);if(K)for(var s of K(t))ae.call(t,s)&&G(e,s,t[s]);return e};import{o as ie,a as b,c as x,w as ce,F as R,r as I,b as d,d as U,e as E,f as $,g as ue,m as de,u as g,h as T,i as fe,j as C,P as he,n as W,t as pe,k as me,l as B,p as X,q as ve,s as ge}from"./vendor.d9267b71.js";const ye=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}};ye();const we={class:"space-y-4 shadow-md Editor"},be=["viewBox"],xe=["onMousemove","x","y","width","height"],_e=["width","height"],ke=["d"],Ee=["width","height"],Ce=["d"],ze=["d","stroke-dasharray"],$e={props:{cells:Array,size:Number,zoom:Number,ratio:Number},emits:["start","stop","draw","undraw"],setup(e,{emit:t}){const s=e;let r=!1,n=!1,o;const l=y=>{o=y,!!n&&t(r?"undraw":"draw",o)},p=()=>{o!==void 0&&t(r?"undraw":"draw",o),t("stop"),o=void 0,r=!1,n=!1},a=y=>{n=!0,t("start"),y.button===0?o!==void 0&&t("draw",o):y.button===2&&(r=!0,o!==void 0&&t("undraw",o))},m=()=>{t("stop"),o=void 0,r=!1,n=!1};return ie(()=>{s.cells.length=[]}),(y,w)=>(b(),x("div",we,[(b(),x("svg",{onContextmenu:w[0]||(w[0]=ce(()=>{},["prevent"])),onMousedown:a,onMouseup:p,onMouseleave:m,width:"100%",height:"100%",viewBox:`0 0 ${e.size*e.ratio} ${e.size*e.ratio}`,style:{"background-color":"#383838"}},[(b(!0),x(R,null,I(e.size,(f,i)=>(b(),x(R,{key:i},[(b(!0),x(R,null,I(e.size,(k,L)=>(b(),x("rect",{key:L,class:"cell",onMousemove:A=>l({x:L,y:i}),x:L*e.ratio,y:i*e.ratio,width:e.ratio,height:e.ratio,fill:"transparent",ref:A=>{A&&(e.cells[L+i*e.size]=A)}},null,40,xe))),128))],64))),128)),d("defs",null,[d("pattern",{id:"grid",width:e.ratio,height:e.ratio,patternUnits:"userSpaceOnUse"},[d("path",{stroke:"#2d2d2d",d:`M 0 0 H ${e.ratio} V ${e.ratio}`,"stroke-width":"2",fill:"none"},null,8,ke)],8,_e)]),d("rect",{class:"pointer-events-none",width:e.size*e.ratio,height:e.size*e.ratio,fill:"url(#grid)"},null,8,Ee),d("path",{stroke:"#2d2d2d",d:`M 0 0 V ${e.size*e.ratio} H ${e.size*e.ratio}`,"stroke-width":"2",fill:"none"},null,8,Ce),d("path",{d:`M ${e.size*e.ratio/2-.5} 0 V ${e.size*e.ratio} M 0 ${e.size*e.ratio/2+.5} H ${e.size*e.ratio}`,"stroke-width":"1","stroke-dasharray":e.size%2==0?"0":"7, 2",stroke:"#232323",fill:"none"},null,8,ze)],40,be))]))}},Le="modulepreload",Z={},je="/",z=function(t,s){return!s||s.length===0?t():Promise.all(s.map(r=>{if(r=`${je}${r}`,r in Z)return;Z[r]=!0;const n=r.endsWith(".css"),o=n?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${o}`))return;const l=document.createElement("link");if(l.rel=n?"stylesheet":Le,n||(l.as="script",l.crossOrigin=""),l.href=r,document.head.appendChild(l),n)return new Promise((p,a)=>{l.addEventListener("load",p),l.addEventListener("error",a)})})).then(()=>t())};var Ae=(e,t)=>{for(const[s,r]of t)e[s]=r;return e};function De(e){switch(e){case"../assets/icons/aspect-ratio.js":return z(()=>import("./aspect-ratio.d8a364f3.js"),[]);case"../assets/icons/delete.js":return z(()=>import("./delete.cb4a964c.js"),[]);case"../assets/icons/download.js":return z(()=>import("./download.bf1f3bb7.js"),[]);case"../assets/icons/file-open.js":return z(()=>import("./file-open.d0f1a2e7.js"),[]);case"../assets/icons/loupe.js":return z(()=>import("./loupe.f094e9b0.js"),[]);case"../assets/icons/palette.js":return z(()=>import("./palette.c25355c5.js"),[]);case"../assets/icons/rotate-left.js":return z(()=>import("./rotate-left.14875334.js"),[]);case"../assets/icons/rotate-right.js":return z(()=>import("./rotate-right.235def9e.js"),[]);case"../assets/icons/save.js":return z(()=>import("./save.17812c1d.js"),[]);case"../assets/icons/upload.js":return z(()=>import("./upload.d8772cde.js"),[]);default:return new Promise(function(t,s){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+e)))})}}const Oe=["innerHTML"],Pe={props:{name:String,fill:String},setup(e){const t=e,s=U({width:24,height:24,viewBox:"0 0 24 24"});let r=E("");$(()=>t.name,o=>{De(`../assets/icons/${o}.js`).then(l=>{s.width=l.default.width,s.height=l.default.height,s.viewBox=`0 0 ${l.default.width} ${l.default.height}`,r.value=l.default.content})},{immediate:!0});let n=ue(()=>t.fill?`--fill-icon: ${t.fill}`:"");return(o,l)=>(b(),x("svg",de({class:"Icon",style:g(n)},g(s),{innerHTML:g(r)}),null,16,Oe))}};var j=Ae(Pe,[["__scopeId","data-v-fbda738a"]]);const J=()=>({serialize:(...s)=>s.join(";"),deserialize:(s,r)=>{const n=r.split(";");return s.reduce((o,l,p)=>M(M({},o),l.includes("...")?{[l.slice(3)]:n.slice(p)}:{[l]:n[p]}),{})}}),Re=e=>{const t=U([]);T(()=>{e.value.addEventListener("change",r)}),fe(()=>{e.value.removeEventListener("change",r)});const s=async n=>{const o=new FileReader;o.onload=l=>{t.push({file:n,result:l.target.result}),e.value.value=null},o.readAsDataURL(n)},r=()=>{t.length=0,[...e.value.files].forEach(n=>s(n)),e.value.value=null};return{files:t}},Ue=e=>({download:s=>{const r=document.createElement("a");r.setAttribute("href","data:text/plain;charset=utf-8,"+s),r.setAttribute("download","fichier.txt"),r.click()}}),Ne={class:"absolute top-0 flex flex-col items-center justify-center gap-4 p-4 text-white text-opacity-75 transform -translate-x-full rounded-md shadow-md -left-4",style:{"background-color":"#232323"}},Se={for:"import"},Me={props:{css:String,size:Number,zoom:Number,cells:Array},emits:["loadPattern","clear"],setup(e,{emit:t}){const s=e,r=E(null),{serialize:n}=J(),{files:o}=Re(r),{download:l}=Ue();$(o,()=>{if(o.length===0)return;const a=atob(o[0].result.split(",")[1]);t("loadPattern",a)});const p=()=>{const a=n(s.size,s.zoom,...s.cells.map(m=>m.getAttribute("fill")));l(encodeURIComponent(a))};return(a,m)=>(b(),x("div",Ne,[d("button",{onClick:m[0]||(m[0]=y=>p()),class:"cursor-pointer"},[C(j,{name:"save"})]),d("input",{ref:(y,w)=>{w.input=y,r.value=y},class:"fixed invisible opacity-0",id:"import",type:"file"},null,512),d("label",Se,[C(j,{class:"cursor-pointer",name:"file-open"})]),d("button",{onClick:m[1]||(m[1]=y=>t("clear")),class:"cursor-pointer"},[C(j,{name:"delete"})])]))}};const Ie=(e,t)=>{const s=U(t);return{push:n=>{s.includes(n)||(s.length>=e&&s.shift(),s.push(n))},stack:s}};const Te=d("span",null,"|",-1),Be={class:"flex flex-row-reverse justify-end flex-grow gap-4"},Ve=["onClick"],He={props:{color:String},emits:["undo","redo","clear","update:color"],setup(e,{emit:t}){const s=e,{push:r,stack:n}=Ie(7,["#ffffff","#000000","#ffd94c","#1bb37d","#f93d54","#216cc7"]),o=E(null),l=E(null);let p;const a=w=>{w!=s.color&&(r(s.color),p.setColor(w),t("update:color",w))};T(()=>{p=he.create({el:o.value,theme:"nano",useAsButton:!0,components:{opacity:!0,hue:!0,interaction:{hex:!0,rgba:!0,input:!0}}});let w;p.on("change",f=>{t("update:color",f.toHEXA()+"")}),p.on("show",()=>w=s.color),p.on("hide",()=>{w!=s.color&&r(w)})});let m=E(!1);const y=()=>{m.value=!m.value,l.value.classList.toggle("ToolBox--rotated")};return(w,f)=>(b(),x("div",{ref:(i,k)=>{k.toolBox=i,l.value=i},class:"absolute flex items-center justify-center gap-4 p-2 text-white text-opacity-75 rounded-md shadow-md -bottom-8 -right-4 ToolBox",style:{"background-color":"#232323"}},[d("button",{ref:(i,k)=>{k.colorPicker=i,o.value=i},class:"cursor-pointer item"},[C(j,{name:"palette"})],512),d("span",{style:W(`background-color: ${e.color}`),class:"w-4 h-4 rounded-md"},null,4),Te,d("ul",Be,[(b(!0),x(R,null,I(g(n),(i,k)=>(b(),x("li",{class:"inline-block w-4 h-4 rounded-md cursor-pointer",key:k,onClick:L=>a(i),style:W(`background-color: ${i}`)},null,12,Ve))),128))]),d("button",{onClick:y,class:"ml-auto cursor-pointer item"},[C(j,{name:g(m)?"rotate-left":"rotate-right"},null,8,["name"])])],512))}},Fe=(e=3e3)=>{const t=E(!1);return{copy:async r=>{if(navigator.clipboard&&window.isSecureContext)try{await navigator.clipboard.writeText(r),t.value=!0,setTimeout(()=>t.value=!1,e)}catch(n){console.error(n)}else{let n=document.createElement("textarea");return n.value=r,n.style.position="fixed",n.style.left="-999999px",n.style.top="-999999px",document.body.appendChild(n),n.focus(),n.select(),new Promise((o,l)=>{document.execCommand("copy")?(t.value=!0,setTimeout(()=>t.value=!1,e)):console.error("Error while copying"),n.remove()})}},copied:t}},qe={class:"flex p-4 text-white text-opacity-75 rounded-md shadow-md gap-x-4",style:{"background-color":"#232323"}},Ke={class:"flex items-center justify-center px-2 py-1 space-x-2 rounded-md",style:{"background-color":"#383838"}},Ge=["value"],We={class:"flex items-center justify-center px-2 py-1 space-x-2 rounded-md",style:{"background-color":"#383838"}},Xe=["value"],Ze={class:"truncate"},Je={props:{css:String,size:Number,zoom:Number},emits:["update:size","update:zoom"],setup(e,{emit:t}){const{copy:s,copied:r}=Fe(1e3);return(n,o)=>(b(),x("div",qe,[d("div",Ke,[C(j,{name:"aspect-ratio",class:"opacity-75"}),d("input",{class:"bg-transparent",type:"number",min:"2",max:"16",value:e.size,onChange:o[0]||(o[0]=l=>t("update:size",+l.target.value))},null,40,Ge)]),d("div",We,[C(j,{name:"loupe",class:"opacity-75"}),d("input",{class:"bg-transparent",type:"number",min:"1",max:"16",value:e.zoom,onChange:o[1]||(o[1]=l=>t("update:zoom",+l.target.value))},null,40,Xe)]),d("div",{class:"flex items-center justify-center px-2 py-1 ml-auto space-x-4 text-white text-opacity-75 bg-blue-200 rounded-md cursor-pointer",style:{"background-color":"#383838"},onClick:o[2]||(o[2]=l=>g(s)(e.css))},[d("span",Ze,pe(g(r)?"Copi\xE9 !":"Copy CSS"),1)])]))}},Qe=e=>{const t=new Set;T(()=>{document.addEventListener("keyup",r),document.addEventListener("keydown",s)}),me(()=>{document.removeEventListener("keyup",r),document.removeEventListener("keydown",s)});const s=n=>{t.add(n.key.toLowerCase());let o=[...t].join("+");e[o]&&e[o]()},r=n=>{t.delete(n.key.toLowerCase())}},_={UNDO:"undo",REDO:"redo"},Ye=()=>{let e=[],t=0,s=null;return{previous:()=>t===0?[]:e[--t],next:()=>t===e.length?[]:e[t++],peekNext:()=>t+1>=e.length?[]:e[t+1],peekCurrent:()=>e[t]||[],peekPrevious:()=>t-1<0?[]:e[t-1],startRegistering:()=>s=[],register:i=>{t<e.length&&(e=e.slice(0,t)),s?s.push(i):e[t++]=[i]},stopRegistering:()=>{s&&s.length!==0&&(e[t++]=s,s=null)},getHistory:()=>e,reset:()=>{e=[],t=0,s=null}}},et=(e,t=4,s)=>{const r=document.createElement("canvas");r.width=r.height=e.value*t.value;const n=E(""),o=()=>{n.value=`url(${r.toDataURL()})`};$(e,()=>{r.width=r.height=e.value*t.value}),$(t,()=>{r.width=r.height=e.value*t.value,p()});const l=(f,i)=>({x:f%i,y:~~(f/i)}),p=()=>{s.forEach((f,i)=>{let k=f.getAttribute("fill");m(i,k)}),o()};$(s,()=>{p()});const a=r.getContext("2d"),m=(f,i)=>{typeof f!="object"&&(f=l(f,e.value)),y(f.x,f.y),a.beginPath(),a.fillStyle=i,a.rect(f.x*t.value,f.y*t.value,t.value,t.value),a.fill()},y=(f,i)=>{a.clearRect(f*t.value,i*t.value,t.value,t.value)};return{updateCell:m,canvas:r,clear:()=>{a.clearRect(0,0,r.width,r.height)},css:n,updateCss:o}},tt={class:"flex flex-col gap-4"},st={class:"relative"},ot={props:{pattern:String},setup(e){const t=e,s="changeCellColor",r="changeSize";let n=E("#000000"),o=E(8),l=E(2),p=E(50);const a=U([]),{previous:m,next:y,peekCurrent:w,peekPrevious:f,startRegistering:i,register:k,stopRegistering:L,reset:A}=Ye(),{updateCell:D,css:N,updateCss:O}=et(o,l,a),{serialize:Q,deserialize:V}=J();Qe({"control+z":()=>H(_.UNDO),"control+y":()=>H(_.REDO)});const Y=()=>{a.forEach((c,u)=>{c.setAttribute("fill","transparent"),D(u,"transparent")}),O()},H=c=>{(c===_.UNDO?m():y()).forEach(({action:h,params:v})=>{if(h===s)a[v.coords.x+v.coords.y*o.value].setAttribute("fill",v[c].color),D(v.coords,v[c].color),O();else if(h===r&&(o.value=v[c].size,c===_.UNDO)){const{colors:P}=V(["...colors"],v[c].colors);X(()=>{a.forEach((ne,S)=>{ne.setAttribute("fill",P[S]),D(S,P[S])})}),O()}})},ee=()=>{i()},te=()=>{L()},se=c=>{F(c,n.value)},oe=c=>{F(c,"transparent")},F=(c,u)=>{const h=a[c.x+c.y*o.value],v=h.getAttribute("fill");v!==u&&(k({action:s,params:{cell:h,coords:c,[_.UNDO]:{color:v},[_.REDO]:{color:u}}}),h.setAttribute("fill",u),D(c,u),O())},q=c=>{const u=V(["size","zoom","...cells"],c);o.value=+u.size,l.value=+u.zoom,X(()=>{a.forEach((h,v)=>{h.setAttribute("fill",u.cells[v]),D(v,u.cells[v])}),O()}),A()};return $(N,()=>{document.body.style.backgroundImage=N.value}),$(o,(c,u)=>{let[h]=w();if(h&&h.params[_.UNDO].size==c&&h.params[_.REDO].size==u)return;let[v]=f();v&&v.params[_.UNDO].size==u&&v.params[_.REDO].size==c||k({action:r,params:{[_.UNDO]:{size:u,colors:Q(...a.map(P=>P.getAttribute("fill")))},[_.REDO]:{size:c}}})}),$(()=>t.pattern,c=>{c&&q(c)}),(c,u)=>(b(),x("div",tt,[C(Je,{css:`background-image: ${g(N)}`,zoom:g(l),"onUpdate:zoom":u[0]||(u[0]=h=>B(l)?l.value=h:l=h),size:g(o),"onUpdate:size":u[1]||(u[1]=h=>B(o)?o.value=h:o=h)},null,8,["css","zoom","size"]),d("div",st,[C(Me,{size:g(o),zoom:g(l),cells:g(a),onLoadPattern:q,onClear:Y},null,8,["size","zoom","cells"]),C($e,{cells:g(a),size:g(o),zoom:g(l),ratio:g(p),onStart:ee,onStop:te,onDraw:se,onUndraw:oe},null,8,["cells","size","zoom","ratio"]),C(He,{color:g(n),"onUpdate:color":u[2]||(u[2]=h=>B(n)?n.value=h:n=h)},null,8,["color"])])]))}};const nt={setup(e){return(t,s)=>(b(),ve(ot,{pattern:t.pattern},null,8,["pattern"]))}};ge(nt).mount("#app");
